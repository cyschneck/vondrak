<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <title>Vondrak</title>
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
</head>
<body>
    
    <div class="section" id="vondrak">
<h1>Vondrak<a class="headerlink" href="#vondrak" title="Permalink to this headline">¶</a></h1>
<p><em>A Python implementation of Vondrák&#8217;s long term precession model and Fortran code.</em></p>
</div>
<div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The earth, like a wobbling top, has an axial precession which complete&#8217;s one complete cycle in approximately 26,000 years. Astronomers often choose a favorite epoch, such as J2000, to express the coordinates of astronomical bodies in celestial coordinates. To convert between orientations, one must use a rotational matrix. This project implements the Vondrák long term precession model to create such a rotational precession matrix. This is relatively accurate for hundreds of thousands of years.</p>
<p>All credit for this precession model goes to Jan Vondrák and his colleagues.</p>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>A rotation matrix allows us to perform a rotation in Euclidean space. The rotation matrix obtained by using the Vondrák ltp model allows us to convert between the celestial orientation of J2000 and another epoch year.</p>
<p>A new position, or orientation, whether for the past or future, can be obtained by computing a rotation matrix for the epoch date of choice. This rotation matrix is then applied to the coordinates of the standard epoch to precess the position. <strong>p₁</strong> = <strong>P·p₀</strong>, where <strong>P</strong> is the precession matrix and <strong>p₀</strong> is the original position. <strong>P</strong> is computed for every epoch date that one wishes to orient to.</p>
<div class="math">
\[\begin{split}p_{1} = P\cdot p_{0} = \begin{pmatrix}
P_{11} &amp; P_{12} &amp; P_{13} \\
P_{21} &amp; P_{22} &amp; P_{23} \\
P_{31} &amp; P_{32} &amp; P_{33}
\end{pmatrix}
\begin{pmatrix}
x\\ y\\ z
\end{pmatrix}
=
\begin{pmatrix}
P_{11}x + P_{12}y + P_{13}z \\
P_{21}x + P_{22}y + P_{23}z \\
P_{31}x + P_{32}y + P_{33}z
\end{pmatrix}\end{split}\]</div>
<p>We now have the new celestial coordinates <strong>p₁</strong> expressed in the new reference epoch. The date is specified in the original computation of position with respect to the standard epoch and then maintained when the rotation matrix is applied.</p>
<p>Additionally, we can convert the coordinates of another epoch to the standard epoch by inverting the precession matrix. We transpose this like so</p>
<div class="math">
\[\begin{split}P^{-1} = \begin{pmatrix}
P_{11} &amp; P_{12} &amp; P_{13} \\
P_{21} &amp; P_{22} &amp; P_{23} \\
P_{31} &amp; P_{32} &amp; P_{33}
\end{pmatrix}\end{split}\]</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://syrte.obspm.fr/jsr/journees2010/pdf/Vondrak.pdf">Some New Thoughts About Long-Term Precession</a> (2010)</li>
<li><a class="reference external" href="http://syrte.obspm.fr/jsr/journees2011/pdf/vondrak.pdf">New Long-Term Expressions for Precession</a> (2011)</li>
<li><a class="reference external" href="http://www.aanda.org/articles/aa/pdf/2011/10/aa17274-11.pdf">New precession expressions, valid for long time intervals</a> (2011)</li>
<li><a class="reference external" href="http://www.aanda.org/articles/aa/abs/2012/05/aa17274e-11/aa17274e-11.html">New precession expressions, valid for long time intervals (Corrigendum)</a> (2012)</li>
</ul>
<p>The documentation is available through the links
in the Table of Contents below.</p>
<p>You can also visit:</p>
<ul class="simple">
<li>Official <a class="reference external" href="https://pypi.python.org/pypi/vondrak">Python Package Index</a>
entry</li>
<li>GitHub <a class="reference external" href="https://github.com/digitalvapor/vondrak/">project page</a></li>
<li>GitHub <a class="reference external" href="https://github.com/digitalvapor/vondrak/issues">issue tracker</a></li>
</ul>
</div>
<div class="section" id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#implementation">Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples.html#periodicity">Periodicity</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#implementation">Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#polaris">Polaris</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Vondrak API</a></li>
</ul>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Some basic usage of the Vondrak module.</p>
<div class="section" id="periodicity">
<h3>Periodicity<a class="headerlink" href="#periodicity" title="Permalink to this headline">¶</a></h3>
<p>This first example, shows the periodicity of ecliptic and equatorial
components of the matrix over 400000 years.</p>
<div class="code python highlight-python"><div class="highlight"><pre>%pylab inline
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Populating the interactive namespace from numpy and matplotlib
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">vondrak</span> <span class="kn">as</span> <span class="nn">v</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ecl_p_matrix_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">equ_p_matrix_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">200001.0</span><span class="p">,</span> <span class="mf">200000.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">year</span><span class="p">:</span>
    <span class="n">p_ecl</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ltp_PECL</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">p_equ</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ltp_PEQU</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ecl_p_matrix_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ecl</span><span class="p">)</span>
    <span class="n">equ_p_matrix_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_equ</span><span class="p">)</span>

<span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">200000</span><span class="p">,</span><span class="mi">200000</span><span class="p">,</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">ecl_p_matrix_list</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>
<span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">200000</span><span class="p">,</span><span class="mi">200000</span><span class="p">,</span><span class="o">-.</span><span class="mi">8</span><span class="p">,</span><span class="mf">1.1</span><span class="p">])</span>
<span class="n">plot</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">equ_p_matrix_list</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/examples_3_0.png" src="_images/examples_3_0.png" />
<img alt="_images/examples_3_1.png" src="_images/examples_3_1.png" />
</div>
<div class="section" id="id1">
<h3>Implementation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>We then will show how to take an initial position (for Polaris) at
J2000, and use the rotation matrix to find the new celestial coordinates
computed for a new epoch.</p>
<p>The new positions (future or past of J2000) are optained by multiplying
the coordinates of the standard epoch by the precession matrix. <strong>p₁</strong> =
<strong>P·p₀</strong>, where <strong>P</strong> is the below precession matrix and <strong>p₀</strong> is the
original position. The precession matrix is unitless.</p>
<div class="math">
\[\begin{split}P = \begin{pmatrix}
P_{11} &amp; P_{12} &amp; P_{13} \\
P_{21} &amp; P_{22} &amp; P_{23} \\
P_{31} &amp; P_{32} &amp; P_{33}
\end{pmatrix}\end{split}\]</div>
<p>P is recomputed for every epoch date.</p>
<div class="math">
\[\begin{split}p_{1} = P\cdot p_{0} = \begin{pmatrix}
P_{11} &amp; P_{12} &amp; P_{13} \\
P_{21} &amp; P_{22} &amp; P_{23} \\
P_{31} &amp; P_{32} &amp; P_{33}
\end{pmatrix}
\begin{pmatrix}
x\\ y\\ z
\end{pmatrix}
=
\begin{pmatrix}
P_{11}x + P_{12}y + P_{13}z \\
P_{21}x + P_{22}y + P_{23}z \\
P_{31}x + P_{32}y + P_{33}z
\end{pmatrix}\end{split}\]</div>
<p>We now have the new celestial coordinates <strong>p₁</strong> expressed in the new
reference epoch. The date is specified in the original computation of
position in J2000 and then maintened when the rotation matrix is
applied.</p>
<p>Additionally, we can convert the coordinates of another epoch to J2000
by inverting the precession matrix. We transpose this like so</p>
<div class="math">
\[\begin{split}P^{-1} = \begin{pmatrix}
P_{11} &amp; P_{12} &amp; P_{13} \\
P_{21} &amp; P_{22} &amp; P_{23} \\
P_{31} &amp; P_{32} &amp; P_{33}
\end{pmatrix}\end{split}\]</div>
</div>
<div class="section" id="polaris">
<h3>Polaris<a class="headerlink" href="#polaris" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">position_matrix</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ra</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">dec</span> <span class="o">==</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">ra</span>  <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="bp">None</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">==</span><span class="bp">None</span> <span class="ow">or</span> <span class="n">z</span><span class="o">==</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">ra</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">ra</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">([[</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">z</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">compute_polaris</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">ephem</span>
    <span class="n">polaris</span> <span class="o">=</span> <span class="n">ephem</span><span class="o">.</span><span class="n">star</span><span class="p">(</span><span class="s">&#39;Polaris&#39;</span><span class="p">)</span>
    <span class="n">polaris</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">),</span><span class="n">epoch</span><span class="o">=</span><span class="s">&#39;2000&#39;</span><span class="p">)</span>
    <span class="n">ra</span> <span class="o">=</span> <span class="n">polaris</span><span class="o">.</span><span class="n">a_ra</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">polaris</span><span class="o">.</span><span class="n">a_dec</span>
    <span class="k">return</span> <span class="n">position_matrix</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ephem</span> <span class="kn">import</span> <span class="n">hours</span> <span class="k">as</span> <span class="n">hrs</span>
<span class="kn">from</span> <span class="nn">ephem</span> <span class="kn">import</span> <span class="n">degrees</span> <span class="k">as</span> <span class="n">deg</span>

<span class="n">p0</span> <span class="o">=</span> <span class="n">compute_polaris</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ra_dec</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;RA: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hrs</span><span class="p">(</span><span class="n">ra</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;DEC: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">deg</span><span class="p">(</span><span class="n">dec</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;cartesian position of Polaris in the year=2000, epoch=2000:&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;{}</span><span class="se">\n</span><span class="s">this vector has length {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">),</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="n">z</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>RA: 2:31:47.10
DEC: 89:15:51.0
cartesian position of Polaris in the year=2000, epoch=2000:
(0.010127331660770541, 0.007897050033378511, 0.99991753347673784)
this vector has length 1.0
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">p0</span> <span class="o">=</span> <span class="n">compute_polaris</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;The position of Polaris at J2000 is </span><span class="se">\n</span><span class="s">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p0</span><span class="p">))</span>
<span class="n">epj</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ltp_PBMAT</span><span class="p">(</span><span class="n">epj</span><span class="p">)</span> <span class="c"># Precession matrix, GCRS</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">compute_polaris</span><span class="p">(</span><span class="n">epj</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">pdp</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;The new position of Polaris in 100000 years is </span><span class="se">\n</span><span class="s">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>The position of Polaris at J2000 is
[[ 0.01012733]
 [ 0.00789705]
 [ 0.99991753]]
The new position of Polaris in 100000 years is
[[ 0.31728427]
 [-0.15847663]
 [ 0.9349951 ]]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ra_dec</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;In hours of right ascension and degrees of declination&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;The position of Polaris at J2000 is&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">hrs</span><span class="p">(</span><span class="n">ra</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="n">deg</span><span class="p">(</span><span class="n">dec</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;The new position of Polaris at 100000 years is&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">ra1</span><span class="p">,</span> <span class="n">dec1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ra_dec</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">hrs</span><span class="p">(</span><span class="n">ra1</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="n">deg</span><span class="p">(</span><span class="n">dec1</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>In hours of right ascension and degrees of declination
The position of Polaris at J2000 is
(&#39;2:31:47.10&#39;, &#39;89:15:51.0&#39;)
The new position of Polaris at 100000 years is
(&#39;-1:46:09.87&#39;, &#39;69:13:38.5&#39;)
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">9000000</span>
<span class="n">bm</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;aeqd&#39;</span><span class="p">,</span>
             <span class="n">lat_0</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mf">280.0</span><span class="p">)</span>
<span class="n">bm</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">bm</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="c"># Position of Polaris at J2000 is p0</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">13001</span><span class="p">,</span> <span class="mi">13000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ltp_PBMAT</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="c"># Precession matrix, GCRS</span>
    <span class="n">p_1</span> <span class="o">=</span> <span class="n">compute_polaris</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
    <span class="n">p_1</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">pdp</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
    <span class="p">(</span><span class="n">ra1</span><span class="p">,</span> <span class="n">dec1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ra_dec</span><span class="p">(</span><span class="n">p_1</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">bm</span><span class="p">(</span><span class="n">degrees</span><span class="p">(</span><span class="n">ra1</span><span class="p">),</span> <span class="n">degrees</span><span class="p">(</span><span class="n">dec1</span><span class="p">))</span>
    <span class="k">if</span><span class="p">(</span><span class="n">year</span> <span class="o">==</span> <span class="n">years</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">bm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">year</span> <span class="o">==</span> <span class="n">years</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">bm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;one cycle of precession is ~26 thousand years&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>one cycle of precession is ~26 thousand years
</pre></div>
</div>
<img alt="_images/examples_9_1.png" src="_images/examples_9_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">width</span> <span class="o">=</span> <span class="mi">9000000</span>
<span class="n">bm</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;aeqd&#39;</span><span class="p">,</span>
             <span class="n">lat_0</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mf">280.0</span><span class="p">)</span>
<span class="n">bm</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">bm</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">200001</span><span class="p">,</span> <span class="mi">200000</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ltp_PBMAT</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="c"># Precession matrix, GCRS</span>
    <span class="n">p_1</span> <span class="o">=</span> <span class="n">compute_polaris</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
    <span class="n">p_1</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">pdp</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">p_1</span><span class="p">)</span>
    <span class="p">(</span><span class="n">ra1</span><span class="p">,</span> <span class="n">dec1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">ra_dec</span><span class="p">(</span><span class="n">p_1</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">bm</span><span class="p">(</span><span class="n">degrees</span><span class="p">(</span><span class="n">ra1</span><span class="p">),</span> <span class="n">degrees</span><span class="p">(</span><span class="n">dec1</span><span class="p">))</span>
    <span class="n">bm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;here is 400000 years of Polaris</span><span class="se">\&#39;</span><span class="s"> precession&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>here is 400000 years of Polaris&#39; precession
</pre></div>
</div>
<img alt="_images/examples_10_1.png" src="_images/examples_10_1.png" />
</div>
</div>
</div>
<div class="section" id="module-vondrak">
<span id="vondrak-api"></span><h1>Vondrak API<a class="headerlink" href="#module-vondrak" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="vondrak.epj">
<tt class="descclassname">vondrak.</tt><tt class="descname">epj</tt><big>(</big><em>dj</em><big>)</big><a class="reference internal" href="_modules/vondrak.html#epj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vondrak.epj" title="Permalink to this definition">¶</a></dt>
<dd><p>Julian Date to Julian Epoch</p>
</dd></dl>

<dl class="function">
<dt id="vondrak.ltp_PBMAT">
<tt class="descclassname">vondrak.</tt><tt class="descname">ltp_PBMAT</tt><big>(</big><em>jepoch</em><big>)</big><a class="reference internal" href="_modules/vondrak.html#ltp_PBMAT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vondrak.ltp_PBMAT" title="Permalink to this definition">¶</a></dt>
<dd><p>Long-term precession matrix, including GCRS frame bias.</p>
<p>Given Julian epoch (TT)</p>
<p>Return precession-bias matrix, J2000.0 to date</p>
<p><tt class="docutils literal"><span class="pre">ltp_PBMAT</span></tt> generates the 3 × 3 rotation matrix <strong>P</strong> × <strong>B</strong>, where <strong>B</strong>
is the “frame bias matrix” that expresses the relative orientation of the
GCRS and mean J2000.0 reference systems. A simple first-order implementation
of the frame bias is used, the departure from rigor being well under 1 μas.</p>
<p>The matrix is in the sense <tt class="docutils literal"><span class="pre">P_date</span> <span class="pre">=</span> <span class="pre">RPB</span> <span class="pre">x</span> <span class="pre">P_J2000</span></tt>,
where <tt class="docutils literal"><span class="pre">P_J2000</span></tt> is a vector in the Geocentric Celestial Reference
System, and P_date is the vector with respect to the Celestial
Intermediate Reference System at that date but with nutation
neglected.</p>
<p>A first order bias formulation is used, of sub-microarcsecond
accuracy compared with a full 3D rotation.</p>
</dd></dl>

<dl class="function">
<dt id="vondrak.ltp_PECL">
<tt class="descclassname">vondrak.</tt><tt class="descname">ltp_PECL</tt><big>(</big><em>jepoch</em><big>)</big><a class="reference internal" href="_modules/vondrak.html#ltp_PECL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vondrak.ltp_PECL" title="Permalink to this definition">¶</a></dt>
<dd><p>Long-term precession of the ecliptic</p>
<p>Given Julian epoch (TT).</p>
<p>Return ecliptic pole unit vector.</p>
<p><tt class="docutils literal"><span class="pre">ltp_PECL</span></tt> generates the unit vector for the pole of the ecliptic, using the series for Pₐ, Qₐ. The vector is with respect to the J2000.0 mean equator and equinox.</p>
</dd></dl>

<dl class="function">
<dt id="vondrak.ltp_PEQU">
<tt class="descclassname">vondrak.</tt><tt class="descname">ltp_PEQU</tt><big>(</big><em>jepoch</em><big>)</big><a class="reference internal" href="_modules/vondrak.html#ltp_PEQU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vondrak.ltp_PEQU" title="Permalink to this definition">¶</a></dt>
<dd><p>Long-term precession of the equator</p>
<p>Given Julian epoch (TT)</p>
<p>Return equator pole unit vector</p>
<p><tt class="docutils literal"><span class="pre">ltp_PEQU</span></tt> generates the unit vector for the pole of the equator, using the series for Xₐ, Yₐ. The vector is with respect to the J2000.0 mean equator and equinox.</p>
</dd></dl>

<dl class="function">
<dt id="vondrak.ltp_PMAT">
<tt class="descclassname">vondrak.</tt><tt class="descname">ltp_PMAT</tt><big>(</big><em>jepoch</em><big>)</big><a class="reference internal" href="_modules/vondrak.html#ltp_PMAT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vondrak.ltp_PMAT" title="Permalink to this definition">¶</a></dt>
<dd><p>Long-term precession matrix</p>
<p>Given Julian epoch (TT)</p>
<p>Return precession matrix, J2000.0 to date</p>
<p><tt class="docutils literal"><span class="pre">ltp_PMAT</span></tt> generates the 3 × 3 rotation matrix <strong>P</strong>, constructed using
Fabri parameterization (i.e. directly from the unit vectors for the ecliptic
and equator poles). The resulting matrix transforms vectors with respect to
the mean equator and equinox of epoch 2000.0 into mean place of date.</p>
<p>The matrix is in the sense <tt class="docutils literal"><span class="pre">P_date</span> <span class="pre">=</span> <span class="pre">RP</span> <span class="pre">x</span> <span class="pre">P_J2000</span></tt>,
where <tt class="docutils literal"><span class="pre">P_J2000</span></tt> is a vector with respect to the J2000.0 mean
equator and equinox and <tt class="docutils literal"><span class="pre">P_date</span></tt> is the same vector with respect to
the equator and equinox of epoch EPJ.</p>
</dd></dl>

<dl class="function">
<dt id="vondrak.pdp">
<tt class="descclassname">vondrak.</tt><tt class="descname">pdp</tt><big>(</big><em>a</em>, <em>b</em><big>)</big><a class="reference internal" href="_modules/vondrak.html#pdp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vondrak.pdp" title="Permalink to this definition">¶</a></dt>
<dd><p>p-vector inner (=scalar=dot) product.</p>
<p>Given two p-vectors (a and b)</p>
<p>Return a * b</p>
</dd></dl>

<dl class="function">
<dt id="vondrak.pn">
<tt class="descclassname">vondrak.</tt><tt class="descname">pn</tt><big>(</big><em>p</em><big>)</big><a class="reference internal" href="_modules/vondrak.html#pn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vondrak.pn" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a p-vector into modulus and unit vector.</p>
<p>Given p-vector (p)</p>
<p>Return modulus (r), and unit vector (u)</p>
</dd></dl>

<dl class="function">
<dt id="vondrak.pxp">
<tt class="descclassname">vondrak.</tt><tt class="descname">pxp</tt><big>(</big><em>a</em>, <em>b</em><big>)</big><a class="reference internal" href="_modules/vondrak.html#pxp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vondrak.pxp" title="Permalink to this definition">¶</a></dt>
<dd><p>p-vector outer (=vector=cross) product.</p>
<p>Given two p-vectors (a and b)
Return a x b</p>
</dd></dl>

<dl class="function">
<dt id="vondrak.ra_dec">
<tt class="descclassname">vondrak.</tt><tt class="descname">ra_dec</tt><big>(</big><em>v</em><big>)</big><a class="reference internal" href="_modules/vondrak.html#ra_dec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vondrak.ra_dec" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a cartesian position matrix to RA and Dec</p>
</dd></dl>

</div>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44642246-11', 'auto');
    ga('send', 'pageview');

    </script>
</body>
</html>